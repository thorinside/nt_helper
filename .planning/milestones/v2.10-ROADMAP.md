# Milestone v2.10: 14-bit MIDI Detection

**Status:** SHIPPED 2026-02-01
**Phases:** 1-3
**Total Plans:** 4

## Overview

Add intelligent 14-bit MIDI CC auto-detection to the MIDI Detector. The detector will run parallel 7-bit and 14-bit detection paths, identify CC pairs (X and X+32), analyze values to determine byte order, and emit typed events that drive the mapping editor to auto-configure for 14-bit control. This enhances the existing 7-bit threshold pattern with pair tracking and value analysis, requiring no new dependencies.

## Phases

### Phase 1: Type System Foundation
**Goal**: Type system supports 14-bit MIDI events without breaking existing detection
**Depends on**: Nothing (first phase)
**Requirements**: TYP-01, TYP-02, TYP-03
**Success Criteria** (what must be TRUE):
  1. MidiEventType enum includes 14-bit variants encoding byte order
  2. Existing 7-bit CC detection continues working unchanged
  3. Existing note detection continues working unchanged
  4. MidiListenerState can emit 14-bit detection results
  5. Freezed code regenerates without errors
**Plans:** 1 plan

Plans:
- [x] 01-01-PLAN.md — Extend MidiEventType enum, update pattern matching, write tests

### Phase 2: 14-Bit Detection
**Goal**: Detector identifies 14-bit CC pairs, determines byte order, and emits typed events
**Depends on**: Phase 1
**Requirements**: DET-01, DET-02, DET-03, DET-04, DET-05, BYT-01, BYT-02
**Success Criteria** (what must be TRUE):
  1. Detector tracks all incoming CC numbers per channel simultaneously
  2. Detector identifies CC pairs where one CC is 32 higher than the other
  3. 14-bit pair detection uses 10-hit threshold (MSB+LSB pair counts as 1 hit)
  4. 7-bit and 14-bit detection run in parallel, first to threshold wins
  5. Reserved CCs (CC0/CC32 Bank Select) excluded from 14-bit pairing
  6. Byte order determined via value analysis (MSB-first vs LSB-first)
  7. Standard MSB-first interpretation used when analysis is ambiguous
  8. Detector emits correct 14-bit event type with byte order encoded
**Plans:** 2 plans

Plans:
- [x] 02-01-PLAN.md — TDD: Create MidiDetectionEngine with pair tracking, byte order analysis, and comprehensive tests
- [x] 02-02-PLAN.md — Wire MidiDetectionEngine into MidiListenerCubit, replacing inline detection

### Phase 3: UI Integration
**Goal**: Mapping editor auto-configures from 14-bit detection results
**Depends on**: Phase 2
**Requirements**: UI-01, UI-02, UI-03, UI-04
**Success Criteria** (what must be TRUE):
  1. Status message shows concise 14-bit result (4-5 words, e.g., "14-bit CC 1 Ch 1")
  2. onMidiEventFound callback delivers 14-bit type info to mapping editor
  3. Mapping editor auto-selects MidiMappingType (cc14BitLow or cc14BitHigh) based on detected byte order
  4. Mapping editor auto-fills CC number from 14-bit detection base CC
  5. 14-bit range slider enabled automatically when 14-bit detection occurs
**Plans:** 1 plan

Plans:
- [x] 03-01-PLAN.md — Update 14-bit status message format and add widget tests

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Type System Foundation | 1/1 | Complete | 2026-01-31 |
| 2. 14-Bit Detection | 2/2 | Complete | 2026-02-01 |
| 3. UI Integration | 1/1 | Complete | 2026-02-01 |

---

## Milestone Summary

**Key Decisions:**
- Auto-detect rather than user-selects mode (smarter detector reduces friction)
- Value analysis for byte order (more reliable than arrival order)
- Same 10-hit threshold for 14-bit (consistency with existing behavior)
- Track CC numbers, no timing window (simplified implementation)
- Enum variant naming: cc14BitLowFirst/cc14BitHighFirst for explicit byte order semantics
- Variance ratio threshold 0.8 for byte order ambiguity
- Ambiguous variance defaults to cc14BitLowFirst (standard MSB-first)
- Cubit delegates all detection logic to MidiDetectionEngine (separation of concerns)
- Concise status format: "14-bit CC X Ch Y" instead of verbose format

**Issues Resolved:**
- None — clean execution across all phases

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
_Archived: 2026-02-01_
