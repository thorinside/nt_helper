{
  "guid": "quan",
  "name": "Quantizer",
  "description": "This algorithm is a multi-channel CV quantizer, loosely based on the Quad Quantizer algorithm on the disting EX. It supports microtuning but this is not a requirement.\n\nIt quantizes CV inputs and generates CV outputs and/or MIDI output.\n\nThe quantization parameters are common to all channels; the individual channels’ parameters are solely related to routing.\n\n**Quantization signal flow:**\n1. The input CV is sampled (triggered by gate input if selected, otherwise when changed sufficiently).\n2. Input transpose is applied (±12-TET semitones).\n3. CV is quantized into the ‘lookup’ scale, yielding a note number.\n4. Shift parameter is applied.\n5. Note number selects a CV in the ‘output’ scale.\n6. Output transpose is applied.\n\n**Modes:**\n- **Nearest/Warped**: Lookup and output scales are identical; input quantized to nearest note (Warped redistributes voltages for even spacing).\n- **Mapped**: Uses 12-TET lookup, maps MIDI note numbers to custom scale via keyboard map (.kbm file).\n\n**Key/Scale/Mode:** Constrains notes to a specific scale (ignored if tuning has ≠12 degrees or microtuning is active). Supports live MIDI scales ('MIDI (any octave)'/'MIDI (exact)').\n\n**Mask:** Overrides key/scale/mode by deselecting specific notes (visualized in GUI for 12-degree tunings).\n\n**GUI:** Shows piano-key visualization of selected notes or channel-specific CV/MIDI data (voltage, note number, cents, tuning ratios).",
  "categories": [
    "CV Processing",
    "MIDI/CV Conversion",
    "Microtonal Tuning",
    "Modular Synthesis"
  ],
  "short_description": "A multi-channel CV quantizer supporting microtuning, scale constraints, and MIDI output with flexible routing.",
  "use_cases": [
    "Microtonal music production (e.g., 31-EDO scales)",
    "LFO-based rhythmic patterns with Warped mode",
    "Live MIDI-to-CV quantization with custom keyboard maps",
    "Pentatonic/blues-scale filtering via mask parameters",
    "Pitch-bend modulation for dynamic tuning adjustments"
  ],
  "gui_description": "Displays either:\n1. **Scale visualization** (for Key/Scale/Mode/Mask parameters): Piano-key layout showing selected/deselected notes, with current output note highlighted.\n2. **Channel details**: Real-time CV/MIDI data (input voltage, sampled voltage, quantized note numbers, output voltage, tuning info in cents or ratios).\n\nTuning-specific displays show equal temperament vs. just intonation differences (e.g., A=900cents ET vs. 5/3 ratio JI).",
  "specifications": [
    {
      "name": "Channels",
      "min": 1,
      "max": 12
    },
    {
      "name": "Sample Rate Compatibility",
      "description": "Standard audio/MIDI sample rates (not explicitly limited)"
    }
  ],
  "parameters": [
    {
      "name": "Quantize mode",
      "min": 0,
      "max": 2,
      "default": 0,
      "enum_values": [
        "Nearest",
        "Mapped",
        "Warped"
      ],
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Input transpose",
      "min": -48,
      "max": 48,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Shift",
      "min": -48,
      "max": 48,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Key",
      "min": -12,
      "max": 12,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Scale",
      "min": 0,
      "max": 10,
      "default": 2,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Mode",
      "min": 1,
      "max": 12,
      "default": 1,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output transpose",
      "min": -48,
      "max": 48,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output gate mode",
      "min": 0,
      "max": 2,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Gate offset",
      "min": 0.0,
      "max": 10.0,
      "default": 2.0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "MIDI channel (in)",
      "min": 0,
      "max": 16,
      "default": 1,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output to breakout",
      "min": 0,
      "max": 1,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output to Select Bus",
      "min": 0,
      "max": 1,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output to USB",
      "min": 0,
      "max": 1,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Output to internal",
      "min": 0,
      "max": 1,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Send pitch bend",
      "min": 0,
      "max": 1,
      "default": 0,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    },
    {
      "name": "Pitch bend range",
      "min": 1,
      "max": 48,
      "default": 2,
      "type": "enum",
      "is_per_channel": false,
      "is_common": true,
      "is_bus": false
    }
  ],
  "input_ports": [
    {
      "name": "CV input",
      "description": "Pitch CV input bus (0-28). Each channel has an independent CV input.",
      "isPerChannel": true
    },
    {
      "name": "Gate input",
      "description": "(Optional) Gate input bus (0-28) to trigger sampling. If unused, CV is sampled on sufficient change.",
      "isPerChannel": true
    }
  ],
  "output_ports": [
    {
      "name": "CV output",
      "description": "Pitch CV output bus (15 by default). Always uses 'Replace' mode.",
      "isPerChannel": true
    },
    {
      "name": "Gate output",
      "description": "Gate/trigger output bus (0 by default), controlled by 'Output gate mode'. Uses 'Replace' mode.",
      "isPerChannel": true
    },
    {
      "name": "Change output",
      "description": "'Change trigger' output bus. Fires a pulse when quantized note changes. Uses 'Replace' mode.",
      "isPerChannel": true
    }
  ]
}